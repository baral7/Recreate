
@*model IEnumerable<BankFull.Models.UserMessage?> *@
    @using BankFull.Controllers;  


   @model dynamic

@{
    ViewData["Title"] = "Index";
}
<div id="clk" style="display:none" class="alert alert-success" role="alert">
  This is a success alert—check it out! 
</div>

<h1 class="text-dark">Assigned</h1>
<hr />



 <ul class="nav nav-pills mb-1 " style="border-bottom:0.3px solid green;">
      
        @if (!User.IsInRole("User"))
        {
             <li class="active"><a data-toggle="tab" href="#home">Assigned</a></li>
            <li><a data-toggle="tab" href="#menu1">Assign Complete</a></li>
        }
        @*  <li><a data-toggle="tab" href="#menu2">Agents</a></li> *@
   
  </ul>

  <div class="tab-content">

      @*SubmitNow*@
    <div id="home" class="tab-pane fade active in bg-white ">

        @*Submit*@
        <table id="example" class="mb-4 table tablecolor wid " style="width:75vw;">
    <thead class="bg-success">
          <tr>
              <th>Mid</th>
              
             <th>
                Name
            </th>
            <th>
                Amount
            </th>
            <th>
                Date
            </th>
            <th>
                Document
            </th>
            
             <th>
                
            </th>
            
          
         
            
        </tr>
            
        
    </thead>
    <tbody>
@foreach (UserMessage item in Model.Assign) {

         
            
                <tr>  
                    <td>
                        @Html.DisplayFor(modelItem => item.MessageId) 
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.tblMessage.BankDetail.Name)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.tblMessage.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.tblMessage.Date)
                    </td>


                    <td>

                        <img src="~/@Html.DisplayFor(modelItem => item.tblMessage.DocumentPath)" width="50px"/>

                    </td>




                    <td>

                        <button type="button" class="btn btn-secondary complete">Complete</button>
                    </td>     

                </tr>
            
        }
    </tbody>
</table>


     
    </div>
      @*Submitted*@

    <div id="menu1" class="tab-pane fade bg-white">
    @*Submitted_data*@

     <table id="exam"  class="mb-4 table tablecolor wid " style="width:75vw;">
    <thead class="bg-danger ">
          <tr>
              <th>Mid</th>
              
             <th>
               Bankname
            </th>
            <th>
               Amount
            </th>
            <th>
               Date
            </th>
            <th>
               Document
            </th>
            
             <th>
                
            </th>
            
          
         
            
        </tr>
            
        
    </thead>
    <tbody>
@foreach (UserMessage item in Model.AssignComplete) {

         
            
                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.MessageId)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.tblMessage.BankDetail.Name)
                    </td>

                    <td>
                        @Html.DisplayFor(modelItem => item.tblMessage.Amount)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.tblMessage.Date)
                    </td>


                    <td>

                        <img src="~/@Html.DisplayFor(modelItem => item.tblMessage.DocumentPath)" width="50px"/>

                    </td>




                    <td>

                       
                    </td>     

                </tr>
            
        }
    </tbody>
</table>



    </div>


    </div>












<script>
   

$(document).ready(function() {




    $(".complete").click(function(e) {

        // var id =  $(this).attr("#data-value");



        var msid = $(this).closest('tr').find("td:eq(0)").text();
        //   var mid = parseInt(msid);


        var Asmid = $(this).closest('tr').find("td:eq(2)").text();
        //   var Amid = parseInt(Asmid);


        console.log(Asmid);


        //   console.log("Hello")
        $.ajax({

            'url': 'https://localhost:44346/Sender/Complete',
            'type': 'Post',
            'data': {
                Asmid, msid

            },
            'success': function() {

                $("#clk").css({
                    "display": "block",
                });
            },
            'error': function() {
                window.location.href = "https://localhost:44346/Users/Assign"
            }
        });
    });


});

   

 $(document).ready(function () {
    $('#example').DataTable();
    $('#exam').DataTable();
});


</script>
    @section scripts{
             @*DataTable*@
   <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
   <link href="https://cdn.datatables.net/1.12.1/css/dataTables.bootstrap.min.css"/>

    <script src = "https://code.jquery.com/jquery-3.5.1.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap.min.js"></script>

       }









  
